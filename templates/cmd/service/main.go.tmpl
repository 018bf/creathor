package main

import (
    "os"

    "github.com/sirupsen/logrus"
    "github.com/urfave/cli/v2"
)

const version = "0.1.0"

const configPath = "configs/config.toml"

func main() {
    logrus.SetFormatter(&logrus.JSONFormatter{FieldMap: log.FieldMap{
        log.FieldKeyTime:  "time",
        log.FieldKeyLevel: "severity",
        log.FieldKeyMsg:   "message",
    }})
    app := &cli.App{
        Name:    "{{ .Name }}",
        Usage:   "service",
        Version: version,
        Flags: []cli.Flag{
            &cli.StringFlag{
                Name:        "config",
                Aliases:     []string{"c"},
                Usage:       "Load configuration from `FILE`",
                EnvVars:     []string{"{{ .Name | ToUpper }}_CONFIG_PATH"},
                TakesFile:   true,
                Value:       configPath,
                DefaultText: configPath,
                HasBeenSet:  false,
            },
        },
        Action: runApp,
    }
    if err := app.Run(os.Args); err != nil {
        logrus.Fatal(err)
    }
}

// runApp - run app
func runApp(context *cli.Context) error {
    panic("implement me")
}
